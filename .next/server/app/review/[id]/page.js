(()=>{var e={};e.id=536,e.ids=[536],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3136:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d}),a(4602),a(1506),a(6560);var s=a(3191),r=a(8716),i=a(7922),n=a.n(i),l=a(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["review",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4602)),"/Users/michaeltornaritis/Desktop/Treasury_Take_Home/app/review/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,1506)),"/Users/michaeltornaritis/Desktop/Treasury_Take_Home/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,6560)),"/Users/michaeltornaritis/Desktop/Treasury_Take_Home/app/not-found.tsx"]}],c=["/Users/michaeltornaritis/Desktop/Treasury_Take_Home/app/review/[id]/page.tsx"],m="/review/[id]/page",u={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/review/[id]/page",pathname:"/review/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6916:()=>{},4889:(e,t,a)=>{Promise.resolve().then(a.bind(a,5068))},1126:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2994,23)),Promise.resolve().then(a.t.bind(a,6114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,9671,23)),Promise.resolve().then(a.t.bind(a,1868,23)),Promise.resolve().then(a.t.bind(a,4759,23))},5303:()=>{},5068:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(326),r=a(7577),i=a(7389),n=a(772),l=a(7863);let o=r.forwardRef(({className:e,...t},a)=>s.jsx("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...t}));o.displayName="Textarea";var d=a(1048);let c=(0,a(9360).j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),m=r.forwardRef(({className:e,variant:t,...a},r)=>s.jsx("div",{ref:r,role:"alert",className:(0,l.cn)(c({variant:t}),e),...a}));m.displayName="Alert",r.forwardRef(({className:e,...t},a)=>s.jsx("h5",{ref:a,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",e),...t})).displayName="AlertTitle";let u=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",e),...t}));u.displayName="AlertDescription";var p=a(5578);let x=(0,p.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),f=(0,p.Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),h=(0,p.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),g=(0,p.Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var v=a(2288);function y(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),[a,l]=(0,r.useState)(null),[c,p]=(0,r.useState)(!0),[y,b]=(0,r.useState)(!1),[j,N]=(0,r.useState)("front"),[w,_]=(0,r.useState)(""),[k,z]=(0,r.useState)(1),[P,A]=(0,r.useState)(!1),[C,R]=(0,r.useState)(null),T=async()=>{try{p(!0);let t=await fetch(`/api/applications/${e.id}`),a=await t.json();l(a.application),a.application.label_images.length>0&&!a.application.label_images.some(e=>e.verification_result)&&D()}catch(e){console.error("Error fetching application:",e)}finally{p(!1)}},D=async()=>{b(!0);try{(await fetch(`/api/applications/${e.id}/verify`,{method:"POST"})).ok?await T():alert("Verification failed")}catch(e){console.error("Verification error:",e),alert("Error during verification")}finally{b(!1)}},V=async(a,s=!1)=>{if("approved"===a&&!s&&Object.values(H).some(e=>e?.type==="hard_mismatch"||e?.type==="not_found")){R(a),A(!0);return}try{(await fetch(`/api/applications/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a,review_notes:w})})).ok?(await T(),("approved"===a||"rejected"===a||"needs_review"===a)&&t.push("/dashboard")):alert("Failed to update status")}catch(e){console.error("Update error:",e),alert("Error updating status")}},q=e=>{if(!e)return"outline";switch(e.type){case"match":return"default";case"soft_mismatch":return"secondary";case"hard_mismatch":case"not_found":return"destructive";default:return"outline"}},M=e=>{if(!e)return null;switch(e.type){case"match":return s.jsx(x,{className:"h-5 w-5 text-green-600"});case"soft_mismatch":return s.jsx(f,{className:"h-5 w-5 text-yellow-600"});case"hard_mismatch":case"not_found":return s.jsx(h,{className:"h-5 w-5 text-red-600"});case"not_applicable":return s.jsx(g,{className:"h-5 w-5 text-gray-500"});default:return null}};if(c)return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"text-lg",children:"Loading application..."})});if(!a)return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"text-lg text-red-600",children:"Application not found"})});let S=a.label_images.find(e=>e.image_type===j),H=S?.verification_result||{};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx(n.z,{variant:"ghost",onClick:()=>t.push("/dashboard"),className:"mb-4",children:"â† Back to Dashboard"}),(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Review Application #",a.id]}),s.jsx("p",{className:"text-gray-600 mt-2",children:a.applicant_name})]}),y&&s.jsx(m,{className:"mb-4",children:s.jsx(u,{children:"Verifying application with AI..."})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Label Images"}),s.jsx("div",{className:"mb-4 flex gap-2",children:a.label_images.map(e=>s.jsx(n.z,{onClick:()=>N(e.image_type),variant:j===e.image_type?"default":"outline",children:e.image_type},e.id))}),S&&(0,s.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,s.jsxs)("div",{className:"mb-2 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["Confidence:"," ",S.confidence_score?`${(100*S.confidence_score).toFixed(1)}%`:"N/A"]}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[s.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>z(Math.max(.5,k-.1)),children:"-"}),(0,s.jsxs)("span",{className:"text-sm w-12 text-center",children:[Math.round(100*k),"%"]}),s.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>z(Math.min(2,k+.1)),children:"+"})]})]}),s.jsx("div",{className:"overflow-auto border rounded",children:S.image_data_base64&&s.jsx("img",{src:`data:${S.mime_type};base64,${S.image_data_base64}`,alt:S.image_type,style:{transform:`scale(${k})`,transformOrigin:"top left"},className:"max-w-full"})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"AI Verification Recommendations"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"These are AI-generated verification results to assist your review. Use your professional judgment to make the final decision."}),0===Object.keys(H).length?s.jsx("div",{className:"text-muted-foreground",children:'No verification results yet. Click "Verify" to process.'}):s.jsx("div",{className:"space-y-3",children:Object.entries(H).map(([e,t])=>s.jsx(m,{variant:"destructive"===q(t)?"destructive":"default",className:"border-2",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[M(t),(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx("div",{className:"font-semibold capitalize",children:e.replace(/_/g," ")}),"not_applicable"===t.type?s.jsx("div",{className:"text-sm mt-1 text-muted-foreground",children:t.expected||"N/A - Not applicable"}):(0,s.jsxs)(s.Fragment,{children:[t.expected&&(0,s.jsxs)("div",{className:"text-sm mt-1",children:[s.jsx("span",{className:"font-medium",children:"Expected:"})," ",t.expected]}),t.extracted&&(0,s.jsxs)("div",{className:"text-sm",children:[s.jsx("span",{className:"font-medium",children:"Extracted:"})," ",t.extracted]}),"not_found"===t.type&&s.jsx("div",{className:"text-sm text-destructive mt-1",children:"Field not found on label"})]})]})]})},e))}),(0,s.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,s.jsxs)(m,{className:"border-blue-200 bg-blue-50",children:[s.jsx(g,{className:"h-4 w-4 text-blue-600"}),(0,s.jsxs)(u,{className:"text-sm text-blue-900",children:[s.jsx("strong",{children:"Your Decision:"})," Review the verification results above, but use your professional judgment. You can approve even if mismatches are flagged, or reject for reasons beyond what the system detected."]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(d._,{htmlFor:"review-notes",children:["Review Notes",s.jsx("span",{className:"text-muted-foreground font-normal ml-2",children:"(Recommended, especially when overriding verification results)"})]}),s.jsx(o,{id:"review-notes",value:w,onChange:e=>_(e.target.value),rows:3,placeholder:"Document your decision rationale, especially if overriding verification results or rejecting for reasons beyond what the system detected..."})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[s.jsx(n.z,{onClick:()=>V("approved"),className:"flex-1",variant:"default",children:"Approve"}),s.jsx(n.z,{onClick:()=>V("rejected"),className:"flex-1",variant:"destructive",children:"Reject"}),s.jsx(n.z,{onClick:()=>V("needs_review"),className:"flex-1",variant:"secondary",children:"Flag for Review"})]})]})]})]})]}),s.jsx(v.Vq,{open:P,onOpenChange:A,children:(0,s.jsxs)(v.cZ,{children:[(0,s.jsxs)(v.fK,{children:[s.jsx(v.$N,{children:"Override Hard Mismatches?"}),s.jsx(v.Be,{children:"This application has hard mismatches or missing fields flagged by the verification system. Are you sure you want to approve it anyway?"})]}),s.jsx("div",{className:"py-4",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"If you proceed, please ensure your review notes explain why you're overriding the verification results. Your professional judgment is the final authority."})}),(0,s.jsxs)(v.cN,{children:[s.jsx(n.z,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),s.jsx(n.z,{onClick:()=>{C&&(V(C,!0),A(!1),R(null))},variant:"default",children:"Yes, Approve Anyway"})]})]})})]})}},772:(e,t,a)=>{"use strict";a.d(t,{z:()=>d});var s=a(326),r=a(7577),i=a(4214),n=a(9360),l=a(7863);let o=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef(({className:e,variant:t,size:a,asChild:r=!1,...n},d)=>{let c=r?i.g7:"button";return s.jsx(c,{className:(0,l.cn)(o({variant:t,size:a,className:e})),ref:d,...n})});d.displayName="Button"},2288:(e,t,a)=>{"use strict";a.d(t,{$N:()=>x,Be:()=>f,Vq:()=>o,cN:()=>p,cZ:()=>m,fK:()=>u});var s=a(326),r=a(7577),i=a(7956),n=a(4019),l=a(7863);let o=i.fC;i.xz;let d=i.h_;i.x8;let c=r.forwardRef(({className:e,...t},a)=>s.jsx(i.aV,{ref:a,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));c.displayName=i.aV.displayName;let m=r.forwardRef(({className:e,children:t,...a},r)=>(0,s.jsxs)(d,{children:[s.jsx(c,{}),(0,s.jsxs)(i.VY,{ref:r,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...a,children:[t,(0,s.jsxs)(i.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(n.Z,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));m.displayName=i.VY.displayName;let u=({className:e,...t})=>s.jsx("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});u.displayName="DialogHeader";let p=({className:e,...t})=>s.jsx("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});p.displayName="DialogFooter";let x=r.forwardRef(({className:e,...t},a)=>s.jsx(i.Dx,{ref:a,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));x.displayName=i.Dx.displayName;let f=r.forwardRef(({className:e,...t},a)=>s.jsx(i.dk,{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",e),...t}));f.displayName=i.dk.displayName},1048:(e,t,a)=>{"use strict";a.d(t,{_:()=>d});var s=a(326),r=a(7577),i=a(9152),n=a(9360),l=a(7863);let o=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef(({className:e,...t},a)=>s.jsx(i.f,{ref:a,className:(0,l.cn)(o(),e),...t}));d.displayName=i.f.displayName},7863:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var s=a(1135),r=a(1009);function i(...e){return(0,r.m6)((0,s.W)(e))}},1506:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i,metadata:()=>r});var s=a(9510);a(7272);let r={title:"Treasury Take Home",description:"Application management and verification system"};function i({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{children:e})})}},6560:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var s=a(9510);function r(){return(0,s.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Not Found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Could not find requested resource"}),s.jsx("a",{href:"/",className:"text-blue-600 hover:underline",children:"Return Home"})]})}},4602:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`/Users/michaeltornaritis/Desktop/Treasury_Take_Home/app/review/[id]/page.tsx#default`)},7272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[276,669,872],()=>a(3136));module.exports=s})();