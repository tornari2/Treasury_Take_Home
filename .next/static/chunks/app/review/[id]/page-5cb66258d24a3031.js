(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{1806:function(e,t,a){Promise.resolve().then(a.bind(a,1720))},1720:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(7437),r=a(2265),i=a(5475),n=a(2869),l=a(4508);let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});o.displayName="Textarea";var c=a(6815);let d=(0,a(535).j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),u=r.forwardRef((e,t)=>{let{className:a,variant:r,...i}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(d({variant:r}),a),...i})});u.displayName="Alert",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})}).displayName="AlertTitle";let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",a),...r})});m.displayName="AlertDescription";var f=a(8755);let x=(0,f.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),p=(0,f.Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),h=(0,f.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),g=(0,f.Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var v=a(6110);function y(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),[a,l]=(0,r.useState)(null),[d,f]=(0,r.useState)(!0),[y,j]=(0,r.useState)(!1),[b,N]=(0,r.useState)("front"),[w,_]=(0,r.useState)(""),[k,z]=(0,r.useState)(1),[C,R]=(0,r.useState)(!1),[A,V]=(0,r.useState)(null);(0,r.useEffect)(()=>{e.id&&O()},[e.id]);let O=async()=>{try{f(!0);let t=await fetch("/api/applications/".concat(e.id)),a=await t.json();l(a.application),a.application.label_images.length>0&&!a.application.label_images.some(e=>e.verification_result)&&S()}catch(e){console.error("Error fetching application:",e)}finally{f(!1)}},S=async()=>{j(!0);try{(await fetch("/api/applications/".concat(e.id,"/verify"),{method:"POST"})).ok?await O():alert("Verification failed")}catch(e){console.error("Verification error:",e),alert("Error during verification")}finally{j(!1)}},E=async function(a){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("approved"===a&&!s&&Object.values(T).some(e=>(null==e?void 0:e.type)==="hard_mismatch"||(null==e?void 0:e.type)==="not_found")){V(a),R(!0);return}try{(await fetch("/api/applications/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a,review_notes:w})})).ok?(await O(),("approved"===a||"rejected"===a||"needs_review"===a)&&t.push("/dashboard")):alert("Failed to update status")}catch(e){console.error("Update error:",e),alert("Error updating status")}},D=e=>{if(!e)return"outline";switch(e.type){case"match":return"default";case"soft_mismatch":return"secondary";case"hard_mismatch":case"not_found":return"destructive";default:return"outline"}},M=e=>{if(!e)return null;switch(e.type){case"match":return(0,s.jsx)(x,{className:"h-5 w-5 text-green-600"});case"soft_mismatch":return(0,s.jsx)(p,{className:"h-5 w-5 text-yellow-600"});case"hard_mismatch":case"not_found":return(0,s.jsx)(h,{className:"h-5 w-5 text-red-600"});case"not_applicable":return(0,s.jsx)(g,{className:"h-5 w-5 text-gray-500"});default:return null}};if(d)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"text-lg",children:"Loading application..."})});if(!a)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"text-lg text-red-600",children:"Application not found"})});let F=a.label_images.find(e=>e.image_type===b),T=(null==F?void 0:F.verification_result)||{};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)(n.z,{variant:"ghost",onClick:()=>t.push("/dashboard"),className:"mb-4",children:"â† Back to Dashboard"}),(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Review Application #",a.id]}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:a.applicant_name})]}),y&&(0,s.jsx)(u,{className:"mb-4",children:(0,s.jsx)(m,{children:"Verifying application with AI..."})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Label Images"}),(0,s.jsx)("div",{className:"mb-4 flex gap-2",children:a.label_images.map(e=>(0,s.jsx)(n.z,{onClick:()=>N(e.image_type),variant:b===e.image_type?"default":"outline",children:e.image_type},e.id))}),F&&(0,s.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,s.jsxs)("div",{className:"mb-2 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["Confidence:"," ",F.confidence_score?"".concat((100*F.confidence_score).toFixed(1),"%"):"N/A"]}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>z(Math.max(.5,k-.1)),children:"-"}),(0,s.jsxs)("span",{className:"text-sm w-12 text-center",children:[Math.round(100*k),"%"]}),(0,s.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>z(Math.min(2,k+.1)),children:"+"})]})]}),(0,s.jsx)("div",{className:"overflow-auto border rounded",children:F.image_data_base64&&(0,s.jsx)("img",{src:"data:".concat(F.mime_type,";base64,").concat(F.image_data_base64),alt:F.image_type,style:{transform:"scale(".concat(k,")"),transformOrigin:"top left"},className:"max-w-full"})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"AI Verification Recommendations"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"These are AI-generated verification results to assist your review. Use your professional judgment to make the final decision."}),0===Object.keys(T).length?(0,s.jsx)("div",{className:"text-muted-foreground",children:'No verification results yet. Click "Verify" to process.'}):(0,s.jsx)("div",{className:"space-y-3",children:Object.entries(T).map(e=>{let[t,a]=e;return(0,s.jsx)(u,{variant:"destructive"===D(a)?"destructive":"default",className:"border-2",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[M(a),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-semibold capitalize",children:t.replace(/_/g," ")}),"not_applicable"===a.type?(0,s.jsx)("div",{className:"text-sm mt-1 text-muted-foreground",children:a.expected||"N/A - Not applicable"}):(0,s.jsxs)(s.Fragment,{children:[a.expected&&(0,s.jsxs)("div",{className:"text-sm mt-1",children:[(0,s.jsx)("span",{className:"font-medium",children:"Expected:"})," ",a.expected]}),a.extracted&&(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"font-medium",children:"Extracted:"})," ",a.extracted]}),"not_found"===a.type&&(0,s.jsx)("div",{className:"text-sm text-destructive mt-1",children:"Field not found on label"})]})]})]})},t)})}),(0,s.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,s.jsxs)(u,{className:"border-blue-200 bg-blue-50",children:[(0,s.jsx)(g,{className:"h-4 w-4 text-blue-600"}),(0,s.jsxs)(m,{className:"text-sm text-blue-900",children:[(0,s.jsx)("strong",{children:"Your Decision:"})," Review the verification results above, but use your professional judgment. You can approve even if mismatches are flagged, or reject for reasons beyond what the system detected."]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c._,{htmlFor:"review-notes",children:["Review Notes",(0,s.jsx)("span",{className:"text-muted-foreground font-normal ml-2",children:"(Recommended, especially when overriding verification results)"})]}),(0,s.jsx)(o,{id:"review-notes",value:w,onChange:e=>_(e.target.value),rows:3,placeholder:"Document your decision rationale, especially if overriding verification results or rejecting for reasons beyond what the system detected..."})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(n.z,{onClick:()=>E("approved"),className:"flex-1",variant:"default",children:"Approve"}),(0,s.jsx)(n.z,{onClick:()=>E("rejected"),className:"flex-1",variant:"destructive",children:"Reject"}),(0,s.jsx)(n.z,{onClick:()=>E("needs_review"),className:"flex-1",variant:"secondary",children:"Flag for Review"})]})]})]})]})]}),(0,s.jsx)(v.Vq,{open:C,onOpenChange:R,children:(0,s.jsxs)(v.cZ,{children:[(0,s.jsxs)(v.fK,{children:[(0,s.jsx)(v.$N,{children:"Override Hard Mismatches?"}),(0,s.jsx)(v.Be,{children:"This application has hard mismatches or missing fields flagged by the verification system. Are you sure you want to approve it anyway?"})]}),(0,s.jsx)("div",{className:"py-4",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"If you proceed, please ensure your review notes explain why you're overriding the verification results. Your professional judgment is the final authority."})}),(0,s.jsxs)(v.cN,{children:[(0,s.jsx)(n.z,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),(0,s.jsx)(n.z,{onClick:()=>{A&&(E(A,!0),R(!1),V(null))},variant:"default",children:"Yes, Approve Anyway"})]})]})})]})}},2869:function(e,t,a){"use strict";a.d(t,{z:function(){return c}});var s=a(7437),r=a(2265),i=a(7053),n=a(535),l=a(4508);let o=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:c=!1,...d}=e,u=c?i.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(o({variant:r,size:n,className:a})),ref:t,...d})});c.displayName="Button"},6110:function(e,t,a){"use strict";a.d(t,{$N:function(){return x},Be:function(){return p},Vq:function(){return o},cN:function(){return f},cZ:function(){return u},fK:function(){return m}});var s=a(7437),r=a(2265),i=a(1),n=a(2489),l=a(4508);let o=i.fC;i.xz;let c=i.h_;i.x8;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});d.displayName=i.aV.displayName;let u=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(d,{}),(0,s.jsxs)(i.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[r,(0,s.jsxs)(i.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(n.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=i.VY.displayName;let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let f=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};f.displayName="DialogFooter";let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});x.displayName=i.Dx.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});p.displayName=i.dk.displayName},6815:function(e,t,a){"use strict";a.d(t,{_:function(){return c}});var s=a(7437),r=a(2265),i=a(370),n=a(535),l=a(4508);let o=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.f,{ref:t,className:(0,l.cn)(o(),a),...r})});c.displayName=i.f.displayName},4508:function(e,t,a){"use strict";a.d(t,{cn:function(){return i}});var s=a(1994),r=a(3335);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}}},function(e){e.O(0,[471,971,117,744],function(){return e(e.s=1806)}),_N_E=e.O()}]);